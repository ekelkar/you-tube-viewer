<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Video Watcher</title>
    <script>
    function loadLocalBootstrapCSS() {
      console.log('Load local Bootstrap CSS');
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'node_modules/bootstrap/dist/css/bootstrap.css';
      console.log('link: ', link);
      document.getElementById('loadBootStrap').append(link);
    };
  </script>

  <!-- Latest compiled and minified CSS -->
  <link id="loadBootStrap" onerror="loadLocalBootstrapCSS()" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" -->
  
  <!--link rel="stylesheet" type="text/css" href="lib/bootstrap.css"-->
  <style type="text/css">
    /* This puts titles always on a separate line from thumbnails */

    #videos-list img {
      display: block;
    }
  </style>

</head>

<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">
          <span style="padding-right: 10px;">
            <img src="images/white-tv.png">
          </span>
          Best Videos Ever
          <!-- ❤ -->
        </a>
      </div>

      <form class="navbar-form navbar-right" role="search">
        <div class="input-group">
          <input class="form-control" id="searchFor" type="text" placeholder="Search">
          <span class="input-group-btn">
            <button class="btn btn-default" id="search" type="button">
              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
            </button>
          </span>
        </div>
  </nav>

  <div class="container">

    <div class="row">
      <div class="col-md-3">

        <!--<div id="thumbnail-videos-list">
          <div class="thumbnail">
            <img src="https://i.ytimg.com/vi/abjpy72Sf6U/default.jpg" alt="No photos">
            <div class="caption">
              <h3>Thumbnail label</h3>
              <p>Text goes here</p>
              <p>
                <a href="#" class="btn btn-primary" role="button">Button</a>
                <a href="#" class="btn btn-default" role="button">Button</a>
              </p>
            </div>
          </div>>
        </div>-->
        <ul class="list-unstyled" id="videos-list3"></ul>
        <ul class="list-unstyled" id="videos-list2"></ul>
        <ul class="list-unstyled" id="videos-list"></ul>
      </div>
      <div class="col-md-9" id="video-watcher"></div>
    </div>
  </div>

  <!-- Scripts are downloaded in the body, so page initially loads faster. 
       It is not clear if it would be better to put jQuery script download
       in the head. -->

  <!-- Use the jQuery provided by Content Delivery Network (CDN) if it is available
      Otherwise, use the local source -->

  <!-- Get jQuery as recommended by code.jquery.com 
       The integrity and crossorigin attributes are used for Subresource Integrity
       (SRI). These attributes are used to check if code stored on remote sites 
       has  been tampered with. -->
  <!--script src="https://code.jquery.com/jquery-3.2.1.js" integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script-->

  <!-- Google's CDN is widely used and likely to be cached on a user's computer. -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Since scripts are executed in the order they appear. The following works
       to load a local copy of jquery. This would not work if either the async
       attribute was set to 'async' or defer was set to 'defer'. -->
  <script>
    window.jQuery || document.write('<script src="/node_modules/jquery/dist/jquery.js"><\/script>')
  </script>

  <!-- Latest compiled and minified CSS -->
  <link id="loadBootStrap" onerror="loadLocalBootstrapCSS()" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" -->

  <!-- Optional theme -->
  <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap-theme.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
    crossorigin="anonymous" -->
  
  <!-- Latest compiled and minified JavaScript -->
  <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
  <!--script src = "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity = "sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin = "anonymous" -->
  </script>
  <script src="youtube.js"></script>
  <script src="you_tube_key.js"></script>
  <script>
    /* TODO: Update the method below using the real data from YouTube
         * hint: debug using the browser developer tools to see the structure
         */
    'use strict';
    // To run code as soon as the document is ready to be manipulated, 
    $(document).ready(function () {
      console.log('document ready jQuery: ', window.jQuery);

      function addVideoToList(video) {

        console.log(video);
        var thumbnailUrl = youtube.generateThumbnailUrl(video.id.videoId);
        var thumbnailImg = $('<img>');
        thumbnailImg.attr('src', video.snippet.thumbnails.default.url);

        var thumbnailUrl2 = youtube.generateThumbnailUrl(video.id.videoId);
        var thumbnailImg2 = $('<img>')
        thumbnailImg2.attr('src', video.snippet.thumbnails.default.url);

        // var tnailImg = $('<img>');
        // tnailImg.attr('src', video.snippet.thumbnails.default.url);

        // Create a div to put info into
        var videoDiv = $('<div>')
        //videoDiv.append(thumbnailImg);
        thumbnailImg.clone().appendTo(videoDiv)
        videoDiv.append($('<p>' + video.snippet.title + '</p>'));
        console.log('videoDiv: ', videoDiv);
        console.log('tni: ', thumbnailImg)

        var videoDiv2 = $('<div>');
        videoDiv2.attr('class', 'thumbnail')
        videoDiv2.append(thumbnailImg);
        console.log('videoDiv2:', videoDiv2);
        console.log('videoDiv: ', videoDiv);
        console.log('tni2: ', thumbnailImg)
        var card = `
      <div class="thumbnail">
        <img src="${video.snippet.thumbnails.default.url}"/> 
        <div class="caption" style="overflow: hidden;">
          <h4>${video.snippet.title}</h4>
          <p>${video.snippet.description} </p>
        </div>
      </div>`
        console.log('card: ', card)

        var captionDiv = $('<div>');
        captionDiv.attr('class', 'caption');
        captionDiv.append($('<h4>' + video.snippet.title + '</h4>'));
        captionDiv.append($('<p>' + video.snippet.description + '</p>'));
        videoDiv2.append(captionDiv);

        videoDiv.on('click', function (e) {
          e.preventDefault();
          var videoTitle = $('<h2>');
          videoTitle.html(video.snippet.title);
          var videoEmbed = $('<iframe></iframe>');
          videoEmbed.attr('src', youtube.generateEmbedUrl(video.id.videoId));
          videoEmbed.attr('width', 560);
          videoEmbed.attr('height', 315);

          var videoWatcher = $('#video-watcher');
          videoWatcher.hide();
          videoWatcher.empty();
          videoWatcher.append(videoTitle);
          videoWatcher.append(videoEmbed);
          videoWatcher.fadeIn();
        });

        var videoItem = $('<li>');
        console.log('videoDiv: ', videoDiv);
        videoItem.append(videoDiv);
        $('#videos-list').append(videoItem);

        var videoItem2 = $('<li>');
        videoItem2.append(videoDiv2);
        $('#videos-list2').append(videoItem2);

        var videoItem3 = $('<li>');
        videoItem3.append(card);
        $('#videos-list3').append(videoItem3);
      }

      // change the query variable to try to get different results from the API
      // var query = "Tie+Dye";

      function queryYouTube(query) {
        $.ajax({
          type: "GET",
          url: "https://www.googleapis.com/youtube/v3/search?part=snippet&q=" +
          query + "&type=video&key=" + youTubeKey,
          dataType: "json",
          success: function (result) {
            for (var i = 0; i < result.items.length; i++) {
              addVideoToList(result.items[i]);
            }
          }
        });
      };

      function emptyVideoList() {
        // Remove any videos currently in the list
        $('#videos-list2').empty();
      };

      $('#searchFor').on('keyup', function (e) {
        console.log('keyCode:', e.keyCode)
        if (e.keyCode === 13) {
          console.log('return entered')
          var query = ''
          e.preventDefault();
          emptyVideoList();
          console.log('Search return');
          query = $('#searchFor').val(); // .trim();
          console.log('Search for: ', query);
          queryYouTube(query);
        }
      });

      $('#search').on('click', function (e) {
        var query = ''
        e.preventDefault();
        emptyVideoList();
        console.log('Search clicked');
        query = $('#searchFor').val();
        console.log('Search for: ', query);
        queryYouTube(query);
      });

      // change the query variable to try to get different results from the API
      var query = "Tie+Dye";
      queryYouTube(query);

      console.log('you tube key:', youTubeKey);
    });
  </script>
</body>

</html>